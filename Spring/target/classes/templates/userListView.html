<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
    <head>
        <title>Quản lý người dùng</title>
    <th:block th:replace="base :: bootstrap"></th:block>
</head>
<body>
    <div th:replace="base :: header"></div>

    <!--<div th:text="${debugMessage}" style="color: red; font-weight: bold;"></div>-->

    <div class="container mt-4">
        <h2 th:text="#{USER_LIST}"></h2>

        <!-- Form lọc -->
        <form method="get" action="#">
            <div class="row g-3 mb-4">
                <div class="col-md-3">
                    <input type="text" name="name" class="form-control" placeholder="Tìm theo tên"
                           th:value="${param.name}">
                </div>
                <div class="col-md-3">
                    <input type="text" name="userCode" class="form-control" placeholder="Tìm theo mã người dùng"
                           th:value="${param.userCode}">
                </div>
                <div class="col-md-3">
                    <select name="role" class="form-select">
                        <option value="">-- Chọn vai trò --</option>
                        <option value="student" th:selected="${currentRole == 'student'}">Sinh viên</option>
                        <option value="teacher" th:selected="${currentRole == 'teacher'}">Giảng viên</option>
                        <!--<option value="staff" th:selected="${currentRole == 'staff'}">Giáo vụ</option>-->
                    </select>
                </div>
                <div class="col-md-3">
                    <button type="submit" class="btn btn-primary">Lọc</button>
                    <a th:href="@{/userListView/}" class="btn btn-secondary">Reset</a>
                    <!--<button class="btn btn-danger">Thêm giảng viên</button>-->
                    <a th:href="@{/addOrUpdateTeacherView/}" class="btn btn-danger">Thêm giảng viên</a>
                </div>
            </div>

            <!--                <ul class="list-group">
                                <li class="list-group-item" th:each="user : ${users}">
                                    <strong th:text="${user.userCode}">Mã</strong> - 
                                    <span th:text="${user.firstName + ' ' + user.lastName}">Tên</span> - 
                                    <span th:text="${user.email}">Email</span> - 
                                    <em th:text="${user.role}">Vai trò</em>
                                </li>
                            </ul>-->

            <table class="table table-striped">
                <thead>
                    <tr>
                        <th></th>
                        <th>Mã</th>
                        <th>Họ và tên</th>
                        <th>vai trò</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody>
                    <tr th:each="u: ${users}">
                        <td>
                            <img th:src="${u.avatar} ?: @{/images/default-avatar.png}"
                                 width="50"
                                 onerror="this.onerror=null;this.src='/images/default-avatar.png';" class="rounded-circle"/>
                            <!--                                 <img th:src="@{/images/default-avatar.png}" width="200" onerror="this.onerror=null;this.src='/images/default-avatar.png';" />-->

                        </td>
                        <td th:text="${u.userCode}"></td>
                        <td th:text="${u.firstName + ' ' + u.lastName}"></td>
                        <td th:text="${u.role}"></td>
                        <td>
                            <a th:href="@{'/addOrUpdateTeacherView/' + ${u.id}} + '/'" th:if="${u.role == 'teacher'}" class="btn btn-success">Sửa️ giảng viên</a>
                        </td>
                    </tr>
                </tbody>
            </table>

        </form>

        <div class="mt-3 d-flex justify-content-between">
            <!-- Nút Trước (bên trái) -->
            <div>
                <form method="get" action="#"
                      th:classappend="${currentPage != null and currentPage != 1} ? '' : 'invisible'">
                    <input type="hidden" name="page" th:value="${currentPage > 1 ? currentPage - 1 : 1}" />
                    <input type="hidden" name="name" th:value="${param.name}" />
                    <button type="submit" class="btn btn-secondary">Trước</button>
                </form>
            </div>

            <!-- Nút Sau (bên phải) -->
            <div>
                <form method="get" action="#"
                      th:classappend="${isLoadMore} ? '' : 'invisible'">
                    <input type="hidden" name="page" th:value="${currentPage + 1}" />
                    <input type="hidden" name="name" th:value="${param.name}" />
                    <button type="submit" class="btn btn-primary">Sau</button>
                </form>
            </div>
        </div>

    </div>

    <div th:replace="base :: footer"></div>
</body>
</html>
